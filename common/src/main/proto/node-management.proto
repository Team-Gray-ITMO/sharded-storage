syntax = "proto3";

option java_multiple_files = true;
option java_package = "vk.itmo.teamgray.sharded.storage.node.management";

package vk.itmo.teamgray.sharded.storage;

service NodeManagementService {
  rpc RearrangeShards (RearrangeShardsRequest) returns (RearrangeShardsResponse);
  rpc MoveShard (MoveShardRequest) returns (MoveShardResponse);
}

message RearrangeShardsRequest {
  // Sorted map of upper bound hash (inclusive) by shard number, lower bound is defined by previous shard (exclusive)
  // For rearrange request, only relevant shards will be included
  map<int32, int64> shardToHash = 1;
}

message RearrangeShardsResponse {
  bool success = 1;
}

message ServerData {
  string host = 1;
  int32 port = 2;
}

message MoveShardRequest {
  int32 shardId = 1;
  ServerData targetServer = 2;
}

message MoveShardResponse {
  bool success = 1;
  string message = 2;
}
